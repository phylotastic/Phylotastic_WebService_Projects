# Use an official Python runtime as a parent image
FROM python:3

RUN apt-get -y update -qq && apt-get install -y --no-install-recommends \
    libqt4-dev libxml2-dev libxslt1-dev python3-numpy python3-pyqt4 python3-lxml python3-six xvfb

# Set the working directory to /tree_viewer
WORKDIR /viewer-service

# Copy the current directory contents into the container at /viewer-service
COPY . /viewer-service

RUN mkdir -p /viewer-service/trees

# Install any needed packages specified in requirements.txt
RUN pip install --trusted-host pypi.python.org -r requirements.txt

RUN pip install --upgrade ete3

# Make port 8989 available to the world outside this container
EXPOSE 8989

# Run app.py when the container launches
CMD ["uwsgi", "/viewer-service/ete_pro.ini"]

